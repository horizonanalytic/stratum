[build.env]
passthrough = ["CARGO_BUILD_JOBS", "OPENSSL_DIR", "OPENSSL_LIB_DIR", "OPENSSL_INCLUDE_DIR"]

[target.x86_64-unknown-linux-gnu]
image = "ghcr.io/cross-rs/x86_64-unknown-linux-gnu:main"
pre-build = ["apt-get update && apt-get install -y libssl-dev pkg-config build-essential g++ cmake"]
# Limit parallel jobs to reduce memory pressure during DuckDB compilation
env = { "CARGO_BUILD_JOBS" = "2", "CMAKE_BUILD_PARALLEL_LEVEL" = "2" }

[target.aarch64-unknown-linux-gnu]
image = "ghcr.io/cross-rs/aarch64-unknown-linux-gnu:main"
pre-build = [
    "dpkg --add-architecture arm64",
    "apt-get update && apt-get install -y build-essential g++ cmake pkg-config libssl-dev:arm64"
]
env = { "CARGO_BUILD_JOBS" = "2", "CMAKE_BUILD_PARALLEL_LEVEL" = "2", "PKG_CONFIG_ALLOW_CROSS" = "1", "PKG_CONFIG_PATH" = "/usr/lib/aarch64-linux-gnu/pkgconfig" }

